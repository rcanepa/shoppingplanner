{% extends "base.html" %}
{% load humanize %}

{% block topbar %}

{% include "administracion/menu.html" %}

{% endblock %}

{% block username %}
	Bienvenido {{ full_name }} !
{% endblock %}

{% block sidebar %}
<h4>M&oacute;dulos</h4>
<ul>
    {% if admin %}
    <li><a href="/categorias/item/create/">Crear Item</a></li>
    {% endif %}
    <li><a href="../../../administracion/index/">Volver</a></li>
</ul>
{% endblock %}

{% block content %}
<h2>Items</h2>

<div id="itemstree">
    <ul id="treeData" style="display: none;">
        {% for item in items %}
            {% for branch, obj in item.as_tree %}
                {% if obj %}
                    {% if branch %}
                        <li id="{{ obj.id }}" class="folder"><a href="/categorias/item/detail/{{ obj.id }}/" target="_self"> {{ obj.nombre }} (Precio: {{ obj.precio|intcomma }})</a>
                        <ul>
                    {% else %}
                        <li id="{{ obj.id }}"><a href="/categorias/item/detail/{{ obj.id }}/" target="_self"> {{ obj.nombre }} (Precio: {{ obj.precio|intcomma }})</a>
                        </li>
                    {% endif %}
                {% else %}
                    {% if branch %}
                        </ul>
                    {% endif %}
                {% endif %}
            {% endfor %}
        {% endfor %}
    </ul>
</div>
{% endblock %}

{% block js %}
<script>

$(function() {
    $("#itemstree").fancytree({
        activate: function(e, data) {
            var node = data.node;
            if( node.data.href ){
                window.open(node.data.href, node.data.target);
            }
        }
    });



});

</script>
{% endblock %}
